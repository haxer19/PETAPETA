local fb = {}

local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

local fullbrightEnabled = false
local connection
local dynamicLight

local function setupFullbright()
    Lighting.Brightness = 2
    Lighting.ClockTime = 14
    Lighting.FogEnd = 100000
    Lighting.GlobalShadows = false
    Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
end

local function createDynamicLight(player)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    dynamicLight = Instance.new("PointLight")
    dynamicLight.Name = "DynamicFullbright"
    dynamicLight.Brightness = 2
    dynamicLight.Range = 30
    dynamicLight.Color = Color3.fromRGB(255, 255, 255)
    dynamicLight.Parent = humanoidRootPart
    
    return dynamicLight
end

function fb:Enable()
    fullbrightEnabled = true
    local player = Players.LocalPlayer
    setupFullbright()
    dynamicLight = createDynamicLight(player)
    if connection then
        connection:Disconnect()
    end
    
    connection = RunService.RenderStepped:Connect(function()
        if fullbrightEnabled and player.Character then
            local character = player.Character
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            if humanoidRootPart and dynamicLight then
                dynamicLight.Parent = humanoidRootPart
            end
        end
    end)

    player.CharacterAdded:Connect(function()
        if fullbrightEnabled then
            dynamicLight = createDynamicLight(player)
        end
    end)
end

return fb